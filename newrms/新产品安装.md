## 新产品安装说明

```
v0.01	2015-10-16	完成安装步骤说明、完成mysql、nginx、tomcat、php、enzo环境安装说明
```

### 安装环境说明
```
mysql==5.1.37
apache tomcat==7.0.64
nginx==1.8.0
php==5.3.3
python==2.7.6
django==1.8.2
redis==2.4.10
```
### 安装步骤说明
```
1. 卸载apache
2. 安装mysql
3. 安装nginx
4. 安装php
	4.1 配置前台程序（/home/boful/web/heuet）
5. 安装tomcat
	5.1 配置后台程序(/home/boful/web/bcms)
6. 安装enzo(python/django/redis)
7. 防火墙配置
8. MooseFS安装
```
#### 1. 卸载apache
`yum remove httpd*`


#### 2. 安装mysql

```
// yum 安装mysql
yum install mysql mysql-server mysql-devel

// 设置mysql开机启动
chkconfig mysqld on

// 修改mysql配置文件,采用UTF-8编码
vi /etc/my.cnf

[mysqld]
datadir=/var/lib/mysql
socket=/var/lib/mysql/mysql.sock
user=mysql
# Disabling symbolic-links is recommended to prevent assorted security risks
symbolic-links=0

default-character-set=utf8	//增加

[client]					//增加
default-character-set=utf8	//增加

[mysqld_safe]
log-error=/var/log/mysqld.log
pid-file=/var/run/mysqld/mysqld.pid

// 设置密码，enzo配置文件默认数据库连接密码root
mysqladmin -u too password "root"
```

#### 3. 安装nginx
```
// 安装nginx
wget http://nginx.org/packages/rhel/6/noarch/RPMS/nginx-release-rhel-6-0.el6.ngx.noarch.rpm
rpm -ivh nginx-release-rhel-6-0.el6.ngx.noarch.rpm
yum install nginx
chkconfig nginx on
```

#### 4. 安装php
```
// 安装php
yum install php

// 安装php支持(最后确定都需要什么)
yum install php-mysql php-gd libjpeg* php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-mcrypt php-bcmath php-mhash libmcrypt libmcrypt-devel php-fpm

// 安装php-fpm
yum install php-fpm

// 设置php-fpm开机启动
chkconfig php-fpm on

// 启动php-fpm
/etc/init.d/php-fpm start

// 修改nginx配置文件（见配置文件，主要修改路径和php支持）
vi /etc/nginx/conf.d/default.conf

// 修改php-fpm配置文件
vi /etc/php-fpm.d/www.conf

# 修改用户和用户组（见配置文件）

// 关闭selinux
setenforce 0

// 修改目录权限（/home/boful默认没有rx权限）
chmod 755 /home/boful
chown root:root /home/boful
```
##### 4.1 配置前台程序（/home/boful/web/heuet）
`拷贝解压即可`

#### 5. tomcat
```
// 安装jdk
yum install java-1.7.0-openjdk-devel.x86_64

// 安装tomcat
wget http://apache.fayea.com/tomcat/tomcat-7/v7.0.64/bin/apache-tomcat-7.0.64.tar.gz
tar zxvf apache-tomcat-7.0.64.tar.gz -C /home/boful/
ln -s /home/boful/apache-tomcat-7.0.64/ /home/boful/tomcat

// 配置后台程序，server.conf
vi /home/boful/tomcat/conf/server.xml

增加<Context path="/bcms" docBase="/home/boful/web/bcms" reloadable="true" />
```
##### 5.1 配置后台程序(/home/boful/web/bcms)
`拷贝解压即可`

#### 6. enzo
##### 6.1 python
```
// 安装python2.7.6	
// 参考http://blog.csdn.net/jcjc918/article/details/11022345
tar xvf Python-2.7.6.tar
./configure
make all
make install
make clean
make distclean

mv /usr/bin/python /usr/bin/python2.6.6
ln -s /usr/local/bin/python2.7 /usr/bin/python

vi /usr/bin/yum
将文件头部的
#!/usr/bin/python

改成
#!/usr/bin/python2.6.6

// 安装python pip
wget https://bootstrap.pypa.io/get-pip.py
python get-pip.py
```

##### 6.2 django
```
// django
tar zxvf Django-1.8.2.tar.gz
cd Django-1.8.2
python setup.py install

// virtualenv
tar zxvf virtualenv-13.1.2.tar.gz
cd virtualenv-13.1.2
python setup.py install
```

##### 6.3 redis
```
tar zxvf redis-2.4.10.tar.gz
cd redis-2.4.10
make
make install

// 启动redis
redis-server
```

##### 6.4 enzo
```
// 参考coding.net上"README.md" 步骤
// 已经添加到目录改名为enzo.md

make deps时根据提示pip install 缺少的东西

django-annoying==0.8.2
django-debug-toolbar==1.3.2
django-mptt==0.7.1
django-extensions==1.5.5
ipython==2.1.0
MySQL-python==1.2.5
pip==1.5.6

// make deps 完成后按照文档一直next
```
#### 7. 配置防火墙
```
需要开放端口80、

```

#### 8. MooseFS（参照官方文档）
```
curl "http://ppa.moosefs.com/RPM-GPG-KEY-MooseFS" > /etc/pki/rpm-gpg/RPM-GPG-KEY-MooseFS
curl "http://ppa.moosefs.com/MooseFS-stable-el6.repo" > /etc/yum.repos.d/MooseFS.repo
yum install moosefs-master moosefs-cli moosefs-cgi moosefs-cgiserv
yum install moosefs-chunkserver
yum install moosefs-metalogger
yum install moosefs-client
```
